<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<title>小球运动</title>
</head>
	<body>
	    <canvas id="canvas_one"></canvas>
		
		<canvas id="canvas_two"></canvas>
	    
	<script type="text/javascript" >
	//椭圆参数
	var a=150,b=80,radius=30;
	time_two=0;//定义运动的执行次数
	
	window.onload=function(){
		//匀速圆周运动
	    var canvas_one=document.getElementById('canvas_one');
	    canvas_one.height=360;
	    canvas_one.width=360;
	    var context=canvas_one.getContext('2d');
	    drawNotChange(context);
	    context.fillStyle='blue';
	    context.beginPath();
	    context.arc(400,400,30,0,2*Math.PI,true);
	    context.closePath();
	    context.fill();
	    setInterval(function(){
	        run(context);
	    }, 50);
	    //匀速椭圆运动
	    var canvas_two=document.getElementById('canvas_two');
	    canvas_two.height=350;
	    canvas_two.width=350;
	    var cxt=canvas_two.getContext('2d');
	    centerPoint(cxt);
	    arcRoute(cxt,180,180,a,b,radius);
	    setInterval(function(){
	        arcRoute(cxt,180,180,a,b,radius);
	    }, 80);
	};
var time_one=0;//定义运动的执行次数
//匀速圆周运动
function run(cxt){
    cxt.clearRect(0,0,400,400);   
    drawNotChange(cxt);
    cxt.save();//将当前以左上角坐标为(0,0)的上下文环境进行保存，这样是为了在接下来中要进行画布偏移后，可以进行还原当前的环境
    cxt.translate(180,180);
    cxt.rotate(time_one*8*Math.PI/180);//设定每次旋转的度数
    cxt.fillStyle='blue';
    cxt.beginPath();
    cxt.arc(0,150,30,0,2*Math.PI,false);
    cxt.closePath();
    cxt.fill();
    cxt.restore();//将当前为(180,180)的点还原为（0,0）,其实在save中就是将上下文环境保存到栈中，在restore下面对其进行还原
    time_one+=1;
}
//绘制不变因素
function drawNotChange(context){
    context.fillStyle='red';
    context.beginPath();
    context.arc(180,180,30,0,2*Math.PI,true);
    context.closePath();
    context.fill();
    context.beginPath();
    context.arc(180,180,150,0,2*Math.PI,true);
    context.closePath();
    context.stroke();
}
//匀速圆周运动结束

//椭圆开始

//绘制原点
function centerPoint(cxt){
    cxt.fillStyle="blue";
    cxt.beginPath();
    cxt.arc(180,180,15,0,2*Math.PI,true)
    cxt.closePath();
    cxt.fill();
}
//椭圆路线绘制
function route(context,x,y,a,b){
   var step = (a > b) ? 1 / a : 1 / b;
   context.beginPath();
   context.moveTo(x + a, y); //从椭圆的左端点开始绘制
   for (var i = 0; i < 2 * Math.PI; i += step)
   {
      context.lineTo(x + a * Math.cos(i), y + b * Math.sin(i));
   }
   context.closePath();
   context.stroke();
}

//椭圆上小球运动的实现
function arcRoute(context,x,y,a,b,r){
    context.clearRect(0,0,400,400);
    route(context,x,x,a,b);
    centerPoint(context);
    var step = (a > b) ? 1 / a : 1 / b;
    context.fillStyle="red";
    if(time_two==0){
        context.beginPath();
        context.arc(x,y,r,0,8*Math.PI,true);
        context.closePath();
        context.fill();
    }else{
    context.beginPath();
    context.arc(x+a*Math.cos(time_two),y+b*Math.sin(time_two),r,0,8*Math.PI,true);
    context.closePath();
    context.fill();
    }
    time_two+=1;
}
//椭圆结束
	    </script>
	</body>
</html>
